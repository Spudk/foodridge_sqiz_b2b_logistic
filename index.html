<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í‘¸ë“œë¦¿ì§€ ë¬¼ë¥˜ ë°œì£¼ ì‹œìŠ¤í…œ</title>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .form-container {
            padding: 40px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.1em;
        }

        .form-group input, 
        .form-group select, 
        .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .form-group input:focus, 
        .form-group select:focus, 
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }

        .warehouse-info {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #c8e6c9;
            margin-bottom: 20px;
        }

        .warehouse-info h3 {
            color: #2e7d32;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .warehouse-details {
            font-size: 0.95em;
            line-height: 1.6;
            color: #1b5e20;
        }

        .pallet-section {
            background: #f1f8ff;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e3f2fd;
            margin-top: 15px;
        }

        .pallet-section h3 {
            color: #1976d2;
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .info-box {
            background: #fff3e0;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            border-left: 4px solid #ff9800;
        }

        .info-box h4 {
            color: #e65100;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            font-size: 0.9em;
            color: #bf360c;
        }

        .info-item {
            background: rgba(255, 152, 0, 0.1);
            padding: 8px 12px;
            border-radius: 5px;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: #667eea;
        }

        .checkbox-group label {
            margin: 0;
            font-size: 1.1em;
            cursor: pointer;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .quantity-btn {
            background: #667eea;
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.2s ease;
        }

        .quantity-btn:hover {
            background: #5a6fd8;
            transform: scale(1.1);
        }

        .quantity-btn:active {
            transform: scale(0.95);
        }

        .auto-calc {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            border: 1px solid #c8e6c9;
        }

        .auto-calc h4 {
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .calc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            font-size: 0.9em;
        }

        .calc-item {
            background: white;
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid #a5d6a7;
        }

        .pallet-layer-option {
            background: #f3e5f5;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 2px solid #e1bee7;
        }

        .hidden {
            display: none;
        }

        .preview-btn, .submit-btn {
            padding: 15px 35px;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .preview-btn {
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .preview-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(76, 175, 80, 0.3);
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .button-group {
            display: flex;
            justify-content: center;
            margin-top: 30px;
        }

        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            padding-bottom: 100px;
        }

        .close {
            position: absolute;
            right: 20px;
            top: 15px;
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #000;
        }

        .preview-content {
            line-height: 1.6;
            color: #333;
        }

        .preview-section {
            margin-bottom: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .preview-section h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .modal-footer {
            position: sticky;
            bottom: 0;
            background: white;
            padding: 20px 0;
            border-top: 2px solid #e1e8ed;
            margin-top: 30px;
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .modal-btn {
            padding: 15px 35px;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .modal-btn-close {
            background: #95a5a6;
            color: white;
        }

        .modal-btn-close:hover {
            background: #7f8c8d;
        }

        .modal-btn-send {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .modal-btn-send:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .modal-btn-send:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        @media (max-width: 768px) {
            .form-row, .form-row-3 {
                grid-template-columns: 1fr;
            }
            
            .container {
                margin: 10px;
            }
            
            .form-container {
                padding: 20px;
            }

            .info-grid, .calc-grid {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
                align-items: center;
            }

            .preview-btn, .submit-btn {
                width: 100%;
                margin: 5px 0;
            }
        }

        .success-message, .error-message {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-left: 4px solid #f39c12;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>í‘¸ë“œë¦¿ì§€</h1>
            <p>ìŠ¤í€´ì¦ˆ ê°ì ë¬¼ë¥˜ ë°œì£¼ ì‹œìŠ¤í…œ</p>
        </div>
        
        <div class="form-container">
            <div class="success-message" id="successMessage">
                ë°œì£¼ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!
            </div>
            
            <div class="error-message" id="errorMessage">
                ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.
            </div>
            
            <form id="logisticsForm">
                <!-- ì°½ê³  ì •ë³´ -->
                <div class="warehouse-info">
                    <h3>ğŸ“ ì¶œë°œì§€ ì°½ê³  ì •ë³´</h3>
                    <div class="warehouse-details">
                        <strong>KCP ë™ì•ˆì„± ì½œë“œì²´ì¸ì„¼í„°</strong><br>
                        ì£¼ì†Œ: ê²½ê¸°ë„ ì•ˆì„±ì‹œ ì¼ì£½ë©´ ì£¼ì²œë¦¬ 73ë²ˆì§€<br>
                        ë‹´ë‹¹ì: ë°•ê¸°ì²œ íŒ€ì¥ë‹˜ (010-7706-7877)<br>
                        <strong style="color: #d32f2f;">â€» ë¹„ê³ : ëª©ì ì§€ ë„ì°©í›„ ìš°ì¸¡ë¨í”„ ì§„ì…</strong>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="loadingTime">ìƒì°¨ì‹œê°„</label>
                        <input type="text" id="loadingTime" name="loadingTime" placeholder="ì˜ˆ: 2025-09-30 09:00" required>
                    </div>
                    <div class="form-group">
                        <label for="productName">ì œí’ˆëª…</label>
                        <input type="text" id="productName" name="productName" value="[FR02001] ìŠ¤í€´ì¦ˆ 9mm ì½”íŒ…ê°ì 12kg" placeholder="ì œí’ˆëª…ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="boxCount">ë°•ìŠ¤ìˆ˜</label>
                    <input type="number" id="boxCount" name="boxCount" value="40" min="1" required>
                    <div class="quantity-controls">
                        <button type="button" class="quantity-btn" onclick="adjustQuantity(-40)">-</button>
                        <span>40ë°•ìŠ¤ ë‹¨ìœ„ ê¶Œì¥ (ìˆ˜ê¸° ì…ë ¥ ê°€ëŠ¥)</span>
                        <button type="button" class="quantity-btn" onclick="adjustQuantity(40)">+</button>
                    </div>
                </div>

                <!-- íŒŒë ˆíŠ¸ ì‚¬ìš© ì—¬ë¶€ -->
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="usePallet" name="usePallet">
                        <label for="usePallet">íŒŒë ˆíŠ¸ ì‚¬ìš©</label>
                    </div>
                </div>

                <!-- íŒŒë ˆíŠ¸ ì •ë³´ ë°•ìŠ¤ -->
                <div class="info-box">
                    <h4>ğŸ“¦ ë¬¼ë¥˜ ì •ë³´</h4>
                    <div class="info-grid">
                        <div class="info-item">íŒŒë ˆíŠ¸ë‹¹ ì ì¬: 40ë°•ìŠ¤ (1ë‹¨ 8ë°•ìŠ¤ Ã— 5ë‹¨)</div>
                        <div class="info-item">ë°•ìŠ¤ ë†’ì´: 26cm</div>
                        <div class="info-item">ë°•ìŠ¤ ì¤‘ëŸ‰: 12kg</div>
                        <div class="info-item">íŒŒë ˆíŠ¸ ë†’ì´: 15cm</div>
                        <div class="info-item">ìµœëŒ€ ì ì¬: 5ë‹¨ (130cm)</div>
                        <div class="info-item">ì´ íŒŒë ˆíŠ¸ ë†’ì´: 145cm (íŒŒë ˆíŠ¸ 15cm + ë°•ìŠ¤ 130cm)</div>
                    </div>
                </div>

                <!-- íŒŒë ˆíŠ¸ ì‚¬ìš©ì‹œ ì •ë³´ -->
                <div id="palletSection" class="pallet-section hidden">
                    <h3>íŒŒë ˆíŠ¸ ì •ë³´</h3>
                    
                    <!-- íŒŒë ˆíŠ¸ 2ë‹¨ ê¹”ê¸° ì˜µì…˜ -->
                    <div class="pallet-layer-option">
                        <div class="checkbox-group">
                            <input type="checkbox" id="doublePallet" name="doublePallet">
                            <label for="doublePallet">íŒŒë ˆíŠ¸ 2ë‹¨ ê¹”ê¸° (íŒŒë ˆíŠ¸ ë†’ì´ 30cm)</label>
                        </div>
                    </div>

                    <div class="form-row-3">
                        <div class="form-group">
                            <label for="itemsPerPallet">íŒŒë ˆíŠ¸ë‹¹ ìƒí’ˆì ì¬</label>
                            <input type="number" id="itemsPerPallet" name="itemsPerPallet" value="40" min="1" readonly>
                        </div>
                        <div class="form-group">
                            <label for="palletHeight">ì´ íŒŒë ˆíŠ¸ ë†’ì´ (cm)</label>
                            <input type="number" id="palletHeight" name="palletHeight" min="145" readonly>
                        </div>
                        <div class="form-group">
                            <label for="palletCount">íŒŒë ˆíŠ¸ ìˆ˜</label>
                            <input type="number" id="palletCount" name="palletCount" min="1" readonly>
                        </div>
                    </div>
                    
                    <div class="auto-calc">
                        <h4>ğŸ”„ ìë™ ê³„ì‚° ê²°ê³¼</h4>
                        <div class="calc-grid" id="calcResults">
                            <!-- ê³„ì‚° ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </div>
                    </div>

                    <div id="warningBox" class="warning-box hidden">
                        âš ï¸ ë°•ìŠ¤ ìˆ˜ê°€ íŒŒë ˆíŠ¸ ìµœëŒ€ ì ì¬ëŸ‰ì„ ì´ˆê³¼í•©ë‹ˆë‹¤. ì¶”ê°€ íŒŒë ˆíŠ¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.
                    </div>
                </div>

                <!-- íŒŒë ˆíŠ¸ ë¯¸ì‚¬ìš©ì‹œ ì •ë³´ -->
                <div id="manualSection" class="pallet-section">
                    <h3>ìˆ˜ì‘ì—… ì •ë³´</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <div class="checkbox-group">
                                <input type="checkbox" id="loadingManual" name="loadingManual">
                                <label for="loadingManual">ìƒì°¨ì‹œ ê¸°ì‚¬ ìˆ˜ì‘ì—…</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="checkbox-group">
                                <input type="checkbox" id="unloadingManual" name="unloadingManual">
                                <label for="unloadingManual">í•˜ì°¨ì‹œ ê¸°ì‚¬ ìˆ˜ì‘ì—…</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ë„ì°© ì •ë³´ -->
                <div class="form-group">
                    <label for="logisticsEmail">ë¬¼ë¥˜ì‚¬ ì´ë©”ì¼ ì£¼ì†Œ</label>
                    <input type="email" id="logisticsEmail" name="logisticsEmail" value="kelly@foodridge.co.kr" placeholder="ë¬¼ë¥˜ì‚¬ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="destination">ë„ì°©ì§€ ì£¼ì†Œ</label>
                        <textarea id="destination" name="destination" rows="3" placeholder="ë„ì°©ì§€ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="destinationContact">ë„ì°©ì§€ ë‹´ë‹¹ì ì—°ë½ì²˜</label>
                        <input type="text" id="destinationContact" name="destinationContact" placeholder="ë‹´ë‹¹ìëª… ë° ì—°ë½ì²˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="arrivalTime">ë„ì°© ìš”ì²­ì‹œê°„ (ë‚ ì§œ ë° ì‹œê°„)</label>
                    <input type="text" id="arrivalTime" name="arrivalTime" placeholder="ì˜ˆ: 2025-09-30 15:00" required>
                </div>

                <!-- ê¸°íƒ€ ìš”ì²­ì‚¬í•­ -->
                <div class="form-group">
                    <label for="additionalRequests">ê¸°íƒ€ ìš”ì²­ì‚¬í•­</label>
                    <textarea id="additionalRequests" name="additionalRequests" rows="4" placeholder="ì¶”ê°€ ìš”ì²­ì‚¬í•­ì´ë‚˜ íŠ¹ë³„í•œ ì§€ì‹œì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)"></textarea>
                </div>

                <div class="button-group">
                    <button type="button" class="preview-btn" onclick="showPreview()">
                        ë¯¸ë¦¬ë³´ê¸°
                    </button>
                    <button type="submit" class="submit-btn" id="submitBtn">
                        ë°œì£¼ ì‹ ì²­í•˜ê¸°
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬ -->
    <div id="previewModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closePreview()">&times;</span>
            <h2 style="margin-bottom: 20px; color: #2c3e50;">ğŸ“‹ ë°œì£¼ ì‹ ì²­ì„œ ë¯¸ë¦¬ë³´ê¸°</h2>
            <div id="previewContent" class="preview-content">
                <!-- ë¯¸ë¦¬ë³´ê¸° ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
            <div class="modal-footer">
                <button type="button" class="modal-btn modal-btn-close" onclick="closePreview()">
                    ë‹«ê¸°
                </button>
                <button type="button" class="modal-btn modal-btn-send" id="sendFromPreviewBtn" onclick="sendFromPreview()">
                    ë°œì£¼ì„œ ì „ì†¡
                </button>
            </div>
        </div>
    </div>

    <script>
        // EmailJS ì´ˆê¸°í™”
        emailjs.init("1gH_A1Z-LUzYv3JUz");

        // ë°•ìŠ¤ ìˆ˜ëŸ‰ ì¡°ì ˆ í•¨ìˆ˜
        function adjustQuantity(amount) {
            const boxCountInput = document.getElementById('boxCount');
            let currentValue = parseInt(boxCountInput.value) || 0;
            const newValue = Math.max(40, currentValue + amount);
            boxCountInput.value = newValue;
            
            // íŒŒë ˆíŠ¸ ê³„ì‚° ì—…ë°ì´íŠ¸
            if (document.getElementById('usePallet').checked) {
                updatePalletCalculations();
            }
        }

        // íŒŒë ˆíŠ¸ ê³„ì‚° ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updatePalletCalculations() {
            const boxCount = parseInt(document.getElementById('boxCount').value) || 0;
            const itemsPerPallet = 40; // 1íŒŒë ˆíŠ¸ë‹¹ 40ë°•ìŠ¤ (8ë°•ìŠ¤ Ã— 5ë‹¨)
            const boxHeight = 26; // cm
            const singlePalletHeight = 15; // cm
            const boxWeight = 12; // kg
            const maxBoxesPerPallet = 40; // ìµœëŒ€ 40ë°•ìŠ¤
            const doublePallet = document.getElementById('doublePallet').checked;

            // íŒŒë ˆíŠ¸ ê¸°ë³¸ ë†’ì´ ì„¤ì •
            const palletBaseHeight = doublePallet ? 30 : 15; // 2ë‹¨ì´ë©´ 30cm, 1ë‹¨ì´ë©´ 15cm
            
            // íŒŒë ˆíŠ¸ ìˆ˜ ê³„ì‚°
            const palletCount = Math.ceil(boxCount / itemsPerPallet);
            
            // ê° íŒŒë ˆíŠ¸ë³„ ë°•ìŠ¤ ìˆ˜ ê³„ì‚°
            const fullPallets = Math.floor(boxCount / itemsPerPallet);
            const remainingBoxes = boxCount % itemsPerPallet;
            
            // í•œ íŒŒë ˆíŠ¸ì˜ ìµœëŒ€ ë†’ì´ ê³„ì‚° (ë°•ìŠ¤ 5ë‹¨ = 130cm)
            const maxBoxHeight = 5 * boxHeight; // 130cm
            const totalHeight = palletBaseHeight + maxBoxHeight; // íŒŒë ˆíŠ¸ + ë°•ìŠ¤
            
            // ì‹¤ì œ ë§ˆì§€ë§‰ íŒŒë ˆíŠ¸ì˜ ë†’ì´ ê³„ì‚°
            const boxesOnLastPallet = remainingBoxes > 0 ? remainingBoxes : itemsPerPallet;
            const layersOnLastPallet = Math.ceil(boxesOnLastPallet / 8); // 1ë‹¨ì— 8ë°•ìŠ¤
            const lastPalletBoxHeight = layersOnLastPallet * boxHeight;
            const lastPalletTotalHeight = palletBaseHeight + lastPalletBoxHeight;
            
            // ì´ ì¤‘ëŸ‰ ê³„ì‚°
            const totalWeight = boxCount * boxWeight;

            // í•„ë“œ ì—…ë°ì´íŠ¸
            document.getElementById('palletCount').value = palletCount;
            document.getElementById('palletHeight').value = totalHeight;

            // ê²½ê³  ë©”ì‹œì§€ í‘œì‹œ/ìˆ¨ê¹€
            const warningBox = document.getElementById('warningBox');
            if (boxCount > maxBoxesPerPallet * palletCount) {
                warningBox.classList.remove('hidden');
            } else {
                warningBox.classList.add('hidden');
            }

            // ê³„ì‚° ê²°ê³¼ í‘œì‹œ
            const calcResults = document.getElementById('calcResults');
            calcResults.innerHTML = `
                <div class="calc-item">ì´ íŒŒë ˆíŠ¸: ${palletCount}ê°œ</div>
                <div class="calc-item">ì™„ì „ íŒŒë ˆíŠ¸: ${fullPallets}ê°œ</div>
                ${remainingBoxes > 0 ? `<div class="calc-item">ë¶€ë¶„ íŒŒë ˆíŠ¸: 1ê°œ (${remainingBoxes}ë°•ìŠ¤)</div>` : ''}
                <div class="calc-item">íŒŒë ˆíŠ¸ ê¸°ë³¸ë†’ì´: ${palletBaseHeight}cm</div>
                <div class="calc-item">ìµœëŒ€ íŒŒë ˆíŠ¸ ë†’ì´: ${totalHeight}cm</div>
                <div class="calc-item">ë§ˆì§€ë§‰ íŒŒë ˆíŠ¸ ë†’ì´: ${lastPalletTotalHeight}cm</div>
                <div class="calc-item">ì´ ì¤‘ëŸ‰: ${totalWeight}kg</div>
                <div class="calc-item">ë§ˆì§€ë§‰ íŒŒë ˆíŠ¸ ì¸µìˆ˜: ${layersOnLastPallet}ì¸µ</div>
            `;
        }

        // íŒŒë ˆíŠ¸ ì‚¬ìš© ì—¬ë¶€ì— ë”°ë¥¸ ë™ì  í•„ë“œ í‘œì‹œ
        document.getElementById('usePallet').addEventListener('change', function() {
            const palletSection = document.getElementById('palletSection');
            const manualSection = document.getElementById('manualSection');
            
            if (this.checked) {
                palletSection.classList.remove('hidden');
                manualSection.classList.add('hidden');
                
                // íŒŒë ˆíŠ¸ ê³„ì‚° ì‹¤í–‰
                updatePalletCalculations();
                
                // ìˆ˜ì‘ì—… í•„ë“œ ì´ˆê¸°í™”
                document.getElementById('loadingManual').checked = false;
                document.getElementById('unloadingManual').checked = false;
            } else {
                palletSection.classList.add('hidden');
                manualSection.classList.remove('hidden');
            }
        });

        // íŒŒë ˆíŠ¸ 2ë‹¨ ê¹”ê¸° ì˜µì…˜ ë³€ê²½ì‹œ ê³„ì‚° ì—…ë°ì´íŠ¸
        document.getElementById('doublePallet').addEventListener('change', function() {
            if (document.getElementById('usePallet').checked) {
                updatePalletCalculations();
            }
        });

        // ë°•ìŠ¤ ìˆ˜ ë³€ê²½ì‹œ íŒŒë ˆíŠ¸ ê³„ì‚° ì—…ë°ì´íŠ¸
        document.getElementById('boxCount').addEventListener('input', function() {
            if (document.getElementById('usePallet').checked) {
                updatePalletCalculations();
            }
        });

        // ë¯¸ë¦¬ë³´ê¸° í•¨ìˆ˜
        function showPreview() {
            const formData = new FormData(document.getElementById('logisticsForm'));
            const data = Object.fromEntries(formData);
            
            // ì²´í¬ë°•ìŠ¤ ê°’ ì²˜ë¦¬
            data.usePallet = document.getElementById('usePallet').checked;
            data.doublePallet = document.getElementById('doublePallet').checked;
            data.loadingManual = document.getElementById('loadingManual').checked;
            data.unloadingManual = document.getElementById('unloadingManual').checked;
            data.logisticsEmail = document.getElementById('logisticsEmail').value;
            
            const previewContent = generatePreviewContent(data);
            document.getElementById('previewContent').innerHTML = previewContent;
            document.getElementById('previewModal').style.display = 'block';
            
            // ì „ì—­ ë³€ìˆ˜ì— í¼ ë°ì´í„° ì €ì¥ (ë¯¸ë¦¬ë³´ê¸°ì—ì„œ ì „ì†¡í•  ë•Œ ì‚¬ìš©)
            window.currentFormData = data;
        }

        function closePreview() {
            document.getElementById('previewModal').style.display = 'none';
        }

        // ë¯¸ë¦¬ë³´ê¸°ì—ì„œ ë°”ë¡œ ì „ì†¡í•˜ëŠ” í•¨ìˆ˜
        function sendFromPreview() {
            const sendFromPreviewBtn = document.getElementById('sendFromPreviewBtn');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');
            
            // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
            sendFromPreviewBtn.disabled = true;
            sendFromPreviewBtn.innerHTML = '<span class="loading"></span>ì „ì†¡ ì¤‘...';
            
            // ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';
            
            // ì €ì¥ëœ í¼ ë°ì´í„° ì‚¬ìš©
            const data = window.currentFormData;
            
            // ì°½ê³  ì •ë³´ ì¶”ê°€
            data.warehouseName = "KCP ë™ì•ˆì„± ì½œë“œì²´ì¸ì„¼í„°";
            data.warehouseAddress = "ê²½ê¸°ë„ ì•ˆì„±ì‹œ ì¼ì£½ë©´ ì£¼ì²œë¦¬ 73ë²ˆì§€";
            data.warehouseContact = "ë°•ê¸°ì²œ íŒ€ì¥ë‹˜ (010-7706-7877)";
            data.warehouseNote = "ëª©ì ì§€ ë„ì°©í›„ ìš°ì¸¡ë¨í”„ ì§„ì…";
            
            // ê³„ì‚°ëœ ì •ë³´ ì¶”ê°€
            if (data.usePallet) {
                const boxCount = parseInt(data.boxCount);
                const totalWeight = boxCount * 12;
                const palletCount = Math.ceil(boxCount / 40);
                data.totalWeight = totalWeight;
                data.calculatedInfo = `ì´ ì¤‘ëŸ‰: ${totalWeight}kg, íŒŒë ˆíŠ¸ ìˆ˜: ${palletCount}ê°œ`;
            }

            // íšŒì‹  ë§í¬ ìƒì„±ì„ ìœ„í•œ ë°œì£¼ ì •ë³´ ì¸ì½”ë”©
            const orderId = 'ORD' + Date.now();
            const responseUrl = generateResponseUrl({
                orderId: orderId,
                loadingTime: data.loadingTime,
                product: data.productName,
                boxCount: data.boxCount,
                destination: data.destination,
                contact: data.destinationContact,
                arrivalTime: data.arrivalTime,
                usePallet: data.usePallet,
                palletCount: data.usePallet ? Math.ceil(parseInt(data.boxCount) / 40) : 0,
                palletLayers: data.doublePallet ? '2ë‹¨ (30cm)' : '1ë‹¨ (15cm)'
            });

            // EmailJSë¡œ ì´ë©”ì¼ ì „ì†¡
            emailjs.send("service_9od6tgr", "template_xk0n34j", {
                to_email: data.logisticsEmail,
                from_email: "kelly@foodridge.co.kr",
                warehouse_name: data.warehouseName,
                warehouse_address: data.warehouseAddress,
                warehouse_contact: data.warehouseContact,
                warehouse_note: data.warehouseNote,
                loading_time: data.loadingTime,
                product_name: data.productName,
                box_count: data.boxCount,
                total_weight: (parseInt(data.boxCount) * 12).toString(),
                use_pallet: data.usePallet ? "ì˜ˆ" : "ì•„ë‹ˆì˜¤",
                pallet_layers: data.doublePallet ? "2ë‹¨ (30cm)" : "1ë‹¨ (15cm)",
                pallet_count: data.usePallet ? Math.ceil(parseInt(data.boxCount) / 40).toString() : "0",
                pallet_height: data.palletHeight || "0",
                loading_manual: data.loadingManual ? "ì˜ˆ" : "ì•„ë‹ˆì˜¤",
                unloading_manual: data.unloadingManual ? "ì˜ˆ" : "ì•„ë‹ˆì˜¤",
                destination_address: data.destination,
                destination_contact: data.destinationContact,
                arrival_time: data.arrivalTime,
                additional_requests: data.additionalRequests || "ì—†ìŒ",
                order_date: new Date().toLocaleString('ko-KR'),
                response_url: responseUrl
            })
                .then(function(response) {
                    console.log('SUCCESS!', response.status, response.text);
                    
                    // ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬ ë‹«ê¸°
                    closePreview();
                    
                    // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
                    successMessage.style.display = 'block';
                    document.querySelector('.container').scrollIntoView({ behavior: 'smooth' });
                }, function(error) {
                    console.log('FAILED...', error);
                    
                    // ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬ ë‹«ê¸°
                    closePreview();
                    
                    // ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
                    errorMessage.textContent = 'ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.text;
                    errorMessage.style.display = 'block';
                    document.querySelector('.container').scrollIntoView({ behavior: 'smooth' });
                })
                .finally(function() {
                    // ë²„íŠ¼ ìƒíƒœ ë³µì›
                    sendFromPreviewBtn.disabled = false;
                    sendFromPreviewBtn.innerHTML = 'ë°œì£¼ì„œ ì „ì†¡';
                });
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
        window.onclick = function(event) {
            const modal = document.getElementById('previewModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }

        function generatePreviewContent(data) {
            const loadingDateTime = data.loadingTime || 'ë¯¸ì…ë ¥';
            const arrivalDateTime = data.arrivalTime || 'ë¯¸ì…ë ¥';
            
            let content = `
                <div class="preview-section">
                    <h4>ğŸ¢ ì¶œë°œì§€ ì •ë³´</h4>
                    <p><strong>ì°½ê³ ëª…:</strong> KCP ë™ì•ˆì„± ì½œë“œì²´ì¸ì„¼í„°</p>
                    <p><strong>ì£¼ì†Œ:</strong> ê²½ê¸°ë„ ì•ˆì„±ì‹œ ì¼ì£½ë©´ ì£¼ì²œë¦¬ 73ë²ˆì§€</p>
                    <p><strong>ë‹´ë‹¹ì:</strong> ë°•ê¸°ì²œ íŒ€ì¥ë‹˜ (010-7706-7877)</p>
                    <p><strong>ë¹„ê³ :</strong> <span style="color: #d32f2f;">ëª©ì ì§€ ë„ì°©í›„ ìš°ì¸¡ë¨í”„ ì§„ì…</span></p>
                    <p><strong>ìƒì°¨ì‹œê°„:</strong> ${loadingDateTime}</p>
                </div>

                <div class="preview-section">
                    <h4>ğŸ“¦ ìƒí’ˆ ì •ë³´</h4>
                    <p><strong>ì œí’ˆëª…:</strong> ${data.productName || 'ë¯¸ì…ë ¥'}</p>
                    <p><strong>ë°•ìŠ¤ìˆ˜:</strong> ${data.boxCount || '0'}ê°œ</p>
                    <p><strong>ì´ ì¤‘ëŸ‰:</strong> ${(parseInt(data.boxCount) || 0) * 12}kg</p>
                </div>

                <div class="preview-section">
                    <h4>ğŸš› íŒŒë ˆíŠ¸ ì •ë³´</h4>`;

            if (data.usePallet) {
                const boxCount = parseInt(data.boxCount) || 0;
                const palletCount = Math.ceil(boxCount / 40);
                const fullPallets = Math.floor(boxCount / 40);
                const remainingBoxes = boxCount % 40;
                const palletBaseHeight = data.doublePallet ? 30 : 15;
                const totalHeight = palletBaseHeight + 130; // ìµœëŒ€ ë†’ì´
                
                content += `
                    <p><strong>íŒŒë ˆíŠ¸ ì‚¬ìš©:</strong> ì˜ˆ</p>
                    <p><strong>íŒŒë ˆíŠ¸ ê¹”ê¸°:</strong> ${data.doublePallet ? '2ë‹¨ (30cm)' : '1ë‹¨ (15cm)'}</p>
                    <p><strong>ì´ íŒŒë ˆíŠ¸ ìˆ˜:</strong> ${palletCount}ê°œ</p>
                    <p><strong>ì™„ì „ íŒŒë ˆíŠ¸:</strong> ${fullPallets}ê°œ</p>
                    ${remainingBoxes > 0 ? `<p><strong>ë¶€ë¶„ íŒŒë ˆíŠ¸:</strong> 1ê°œ (${remainingBoxes}ë°•ìŠ¤)</p>` : ''}
                    <p><strong>íŒŒë ˆíŠ¸ë‹¹ ì ì¬ëŸ‰:</strong> 40ë°•ìŠ¤</p>
                    <p><strong>ìµœëŒ€ íŒŒë ˆíŠ¸ ë†’ì´:</strong> ${totalHeight}cm</p>`;
            } else {
                content += `
                    <p><strong>íŒŒë ˆíŠ¸ ì‚¬ìš©:</strong> ì•„ë‹ˆì˜¤</p>
                    <p><strong>ìƒì°¨ì‹œ ê¸°ì‚¬ ìˆ˜ì‘ì—…:</strong> ${data.loadingManual ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}</p>
                    <p><strong>í•˜ì°¨ì‹œ ê¸°ì‚¬ ìˆ˜ì‘ì—…:</strong> ${data.unloadingManual ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}</p>`;
            }

            content += `
                </div>

                <div class="preview-section">
                    <h4>ğŸ“ ë„ì°©ì§€ ì •ë³´</h4>
                    <p><strong>ë„ì°©ì§€ ì£¼ì†Œ:</strong> ${data.destination || 'ë¯¸ì…ë ¥'}</p>
                    <p><strong>ë‹´ë‹¹ì ì—°ë½ì²˜:</strong> ${data.destinationContact || 'ë¯¸ì…ë ¥'}</p>
                    <p><strong>ë„ì°© ìš”ì²­ì‹œê°„:</strong> ${arrivalDateTime}</p>
                </div>`;

            if (data.additionalRequests && data.additionalRequests.trim()) {
                content += `
                    <div class="preview-section">
                        <h4>ğŸ“ ê¸°íƒ€ ìš”ì²­ì‚¬í•­</h4>
                        <p>${data.additionalRequests}</p>
                    </div>`;
            }

            content += `
                <div class="preview-section">
                    <h4>ğŸ“§ ë°œì†¡ ì •ë³´</h4>
                    <p><strong>ë¬¼ë¥˜ì‚¬ ì´ë©”ì¼:</strong> ${data.logisticsEmail || 'kelly@foodridge.co.kr'}</p>
                    <p><strong>ë°œì‹ ì:</strong> kelly@foodridge.co.kr</p>
                </div>

                <div class="preview-section">
                    <h4>ğŸ“Š ë¬¼ë¥˜ ìƒì„¸ ì •ë³´</h4>
                    <p><strong>ë°•ìŠ¤ ê·œê²©:</strong> 26cm ë†’ì´, 12kg ì¤‘ëŸ‰</p>
                    <p><strong>íŒŒë ˆíŠ¸ ê·œê²©:</strong> 15cm ë†’ì´ (2ë‹¨ì‹œ 30cm)</p>
                    <p><strong>ì ì¬ ë°©ì‹:</strong> 1ë‹¨ 8ë°•ìŠ¤ Ã— ìµœëŒ€ 5ë‹¨</p>
                </div>

                <div class="preview-section">
                    <h4>ğŸ• ë°œì£¼ ì •ë³´</h4>
                    <p><strong>ì‹ ì²­ì¼ì‹œ:</strong> ${new Date().toLocaleString('ko-KR')}</p>
                    <p><strong>ì‹œìŠ¤í…œ:</strong> í‘¸ë“œë¦¿ì§€ ë¬¼ë¥˜ ë°œì£¼ ì‹œìŠ¤í…œ</p>
                </div>
            `;

            return content;
        }

        // í¼ ì œì¶œ ì²˜ë¦¬
        document.getElementById('logisticsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');
            
            // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="loading"></span>ì „ì†¡ ì¤‘...';
            
            // ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';
            
            // í¼ ë°ì´í„° ìˆ˜ì§‘
            const formData = new FormData(this);
            const data = Object.fromEntries(formData);
            
            // ì²´í¬ë°•ìŠ¤ ê°’ ì²˜ë¦¬
            data.usePallet = document.getElementById('usePallet').checked;
            data.doublePallet = document.getElementById('doublePallet').checked;
            data.loadingManual = document.getElementById('loadingManual').checked;
            data.unloadingManual = document.getElementById('unloadingManual').checked;
            
            // ë¬¼ë¥˜ì‚¬ ì´ë©”ì¼
            data.logisticsEmail = document.getElementById('logisticsEmail').value;
            
            // ì°½ê³  ì •ë³´ ì¶”ê°€
            data.warehouseName = "KCP ë™ì•ˆì„± ì½œë“œì²´ì¸ì„¼í„°";
            data.warehouseAddress = "ê²½ê¸°ë„ ì•ˆì„±ì‹œ ì¼ì£½ë©´ ì£¼ì²œë¦¬ 73ë²ˆì§€";
            data.warehouseContact = "ë°•ê¸°ì²œ íŒ€ì¥ë‹˜ (010-7706-7877)";
            data.warehouseNote = "ëª©ì ì§€ ë„ì°©í›„ ìš°ì¸¡ë¨í”„ ì§„ì…";
            
            // ê³„ì‚°ëœ ì •ë³´ ì¶”ê°€
            if (data.usePallet) {
                const boxCount = parseInt(data.boxCount);
                const totalWeight = boxCount * 12;
                const palletCount = Math.ceil(boxCount / 40);
                data.totalWeight = totalWeight;
                data.calculatedInfo = `ì´ ì¤‘ëŸ‰: ${totalWeight}kg, íŒŒë ˆíŠ¸ ìˆ˜: ${palletCount}ê°œ`;
            }

            // íšŒì‹  ë§í¬ ìƒì„±ì„ ìœ„í•œ ë°œì£¼ ì •ë³´ ì¸ì½”ë”©
            const orderId = 'ORD' + Date.now(); // ê³ ìœ  ë°œì£¼ ID ìƒì„±
            const responseUrl = generateResponseUrl({
                orderId: orderId,
                loadingTime: data.loadingTime,
                product: data.productName,
                boxCount: data.boxCount,
                destination: data.destination,
                contact: data.destinationContact,
                arrivalTime: data.arrivalTime,
                usePallet: data.usePallet,
                palletCount: data.usePallet ? Math.ceil(parseInt(data.boxCount) / 40) : 0,
                palletLayers: data.doublePallet ? '2ë‹¨ (30cm)' : '1ë‹¨ (15cm)'
            });

            // EmailJSë¡œ ì´ë©”ì¼ ì „ì†¡
            emailjs.send("service_9od6tgr", "template_xk0n34j", {
                to_email: data.logisticsEmail, // ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë¬¼ë¥˜ì‚¬ ì´ë©”ì¼
                from_email: "kelly@foodridge.co.kr",
                warehouse_name: data.warehouseName,
                warehouse_address: data.warehouseAddress,
                warehouse_contact: data.warehouseContact,
                warehouse_note: data.warehouseNote,
                loading_time: data.loadingTime,
                product_name: data.productName,
                box_count: data.boxCount,
                total_weight: (parseInt(data.boxCount) * 12).toString(),
                use_pallet: data.usePallet ? "ì˜ˆ" : "ì•„ë‹ˆì˜¤",
                pallet_layers: data.doublePallet ? "2ë‹¨ (30cm)" : "1ë‹¨ (15cm)",
                pallet_count: data.usePallet ? Math.ceil(parseInt(data.boxCount) / 40).toString() : "0",
                pallet_height: data.palletHeight || "0",
                loading_manual: data.loadingManual ? "ì˜ˆ" : "ì•„ë‹ˆì˜¤",
                unloading_manual: data.unloadingManual ? "ì˜ˆ" : "ì•„ë‹ˆì˜¤",
                destination_address: data.destination,
                destination_contact: data.destinationContact,
                arrival_time: data.arrivalTime,
                additional_requests: data.additionalRequests || "ì—†ìŒ",
                order_date: new Date().toLocaleString('ko-KR'),
                response_url: responseUrl // íšŒì‹  ë§í¬ ì¶”ê°€
            })
                .then(function(response) {
                    console.log('SUCCESS!', response.status, response.text);
                    successMessage.style.display = 'block';
                    document.querySelector('.container').scrollIntoView({ behavior: 'smooth' });
                    
                    // í¼ ì´ˆê¸°í™” (ì„ íƒì‚¬í•­)
                    // document.getElementById('logisticsForm').reset();
                }, function(error) {
                    console.log('FAILED...', error);
                    errorMessage.textContent = 'ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.text;
                    errorMessage.style.display = 'block';
                    document.querySelector('.container').scrollIntoView({ behavior: 'smooth' });
                })
                .finally(function() {
                    // ë²„íŠ¼ ìƒíƒœ ë³µì›
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = 'ë°œì£¼ ì‹ ì²­í•˜ê¸°';
                });
        });

        function generateEmailBody(data) {
            const loadingDateTime = data.loadingTime;
            const arrivalDateTime = data.arrivalTime;
            
            let body = `
í‘¸ë“œë¦¿ì§€ ë¬¼ë¥˜ ë°œì£¼ ì‹ ì²­ì„œ

=== ì¶œë°œì§€ ì •ë³´ ===
â€¢ ì°½ê³ ëª…: ${data.warehouseName}
â€¢ ì£¼ì†Œ: ${data.warehouseAddress}
â€¢ ë‹´ë‹¹ì: ${data.warehouseContact}
â€¢ ë¹„ê³ : ${data.warehouseNote}
â€¢ ìƒì°¨ì‹œê°„: ${loadingDateTime}

=== ìƒí’ˆ ì •ë³´ ===
â€¢ ì œí’ˆëª…: ${data.productName}
â€¢ ë°•ìŠ¤ìˆ˜: ${data.boxCount}ê°œ
â€¢ ì´ ì¤‘ëŸ‰: ${parseInt(data.boxCount) * 12}kg

=== íŒŒë ˆíŠ¸ ì •ë³´ ===`;

            if (data.usePallet) {
                const boxCount = parseInt(data.boxCount);
                const palletCount = Math.ceil(boxCount / 40);
                const fullPallets = Math.floor(boxCount / 40);
                const remainingBoxes = boxCount % 40;
                const palletBaseHeight = data.doublePallet ? 30 : 15;
                
                body += `
â€¢ íŒŒë ˆíŠ¸ ì‚¬ìš©: ì˜ˆ
â€¢ íŒŒë ˆíŠ¸ ê¹”ê¸°: ${data.doublePallet ? '2ë‹¨ (30cm)' : '1ë‹¨ (15cm)'}
â€¢ ì´ íŒŒë ˆíŠ¸ ìˆ˜: ${palletCount}ê°œ
â€¢ ì™„ì „ íŒŒë ˆíŠ¸: ${fullPallets}ê°œ
${remainingBoxes > 0 ? `â€¢ ë¶€ë¶„ íŒŒë ˆíŠ¸: 1ê°œ (${remainingBoxes}ë°•ìŠ¤)` : ''}
â€¢ íŒŒë ˆíŠ¸ë‹¹ ì ì¬ëŸ‰: 40ë°•ìŠ¤ (1ë‹¨ 8ë°•ìŠ¤ Ã— 5ë‹¨)
â€¢ ìµœëŒ€ íŒŒë ˆíŠ¸ ë†’ì´: ${palletBaseHeight + 130}cm`;
            } else {
                body += `
â€¢ íŒŒë ˆíŠ¸ ì‚¬ìš©: ì•„ë‹ˆì˜¤
â€¢ ìƒì°¨ì‹œ ê¸°ì‚¬ ìˆ˜ì‘ì—…: ${data.loadingManual ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}
â€¢ í•˜ì°¨ì‹œ ê¸°ì‚¬ ìˆ˜ì‘ì—…: ${data.unloadingManual ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}`;
            }

            body += `

=== ë„ì°©ì§€ ì •ë³´ ===
â€¢ ë„ì°©ì§€ ì£¼ì†Œ: ${data.destination}
â€¢ ë‹´ë‹¹ì ì—°ë½ì²˜: ${data.destinationContact}
â€¢ ë„ì°© ìš”ì²­ì‹œê°„: ${arrivalDateTime}`;

            if (data.additionalRequests && data.additionalRequests.trim()) {
                body += `

=== ê¸°íƒ€ ìš”ì²­ì‚¬í•­ ===
${data.additionalRequests}`;
            }

            body += `

=== ë°œì†¡ ì •ë³´ ===
â€¢ ë¬¼ë¥˜ì‚¬ ì´ë©”ì¼: ${data.logisticsEmail}
â€¢ ë°œì‹ ì: kelly@foodridge.co.kr

=== ë¬¼ë¥˜ ìƒì„¸ ì •ë³´ ===
â€¢ ë°•ìŠ¤ ê·œê²©: 26cm ë†’ì´, 12kg ì¤‘ëŸ‰
â€¢ íŒŒë ˆíŠ¸ ê·œê²©: 15cm ë†’ì´ (2ë‹¨ì‹œ 30cm)
â€¢ ì ì¬ ë°©ì‹: 1ë‹¨ 8ë°•ìŠ¤ Ã— ìµœëŒ€ 5ë‹¨

---
ë°œì£¼ ì‹ ì²­ì¼ì‹œ: ${new Date().toLocaleString('ko-KR')}
ì‹œìŠ¤í…œ: í‘¸ë“œë¦¿ì§€ ë¬¼ë¥˜ ë°œì£¼ ì‹œìŠ¤í…œ
            `;

            return body;
        }

        // íšŒì‹  ë§í¬ URL ìƒì„± í•¨ìˆ˜
        function generateResponseUrl(orderData) {
            // íšŒì‹  ì‹œìŠ¤í…œ í˜ì´ì§€ì˜ ê¸°ë³¸ URL (ì‹¤ì œ ë°°í¬ì‹œ ìˆ˜ì • í•„ìš”)
            const baseUrl = window.location.origin + window.location.pathname.replace('foodridge_logistics_system.html', 'logistics_response_system.html');
            
            // URL íŒŒë¼ë¯¸í„°ë¡œ ë°œì£¼ ì •ë³´ ì „ë‹¬
            const params = new URLSearchParams({
                orderId: orderData.orderId,
                loadingTime: orderData.loadingTime,
                product: orderData.product,
                boxCount: orderData.boxCount,
                destination: orderData.destination,
                contact: orderData.contact,
                arrivalTime: orderData.arrivalTime,
                usePallet: orderData.usePallet,
                palletCount: orderData.palletCount,
                palletLayers: orderData.palletLayers
            });
            
            return `${baseUrl}?${params.toString()}`;
        }

        // ì´ˆê¸° ì„¤ì •
        document.addEventListener('DOMContentLoaded', function() {
            // í˜„ì¬ ë‚ ì§œì™€ ì‹œê°„ì„ 24ì‹œê°„ í˜•ì‹ìœ¼ë¡œ ì„¤ì •
            const now = new Date();
            const tomorrow = new Date(now.getTime() + 24 * 60 * 60 * 1000);
            
            // ë‚´ì¼ ì˜¤ì „ 9ì‹œë¡œ ê¸°ë³¸ ì„¤ì • (24ì‹œê°„ í˜•ì‹)
            const year = tomorrow.getFullYear();
            const month = String(tomorrow.getMonth() + 1).padStart(2, '0');
            const day = String(tomorrow.getDate()).padStart(2, '0');
            const tomorrowString = `${year}-${month}-${day} 09:00`;
            
            document.getElementById('loadingTime').placeholder = tomorrowString;
            document.getElementById('arrivalTime').placeholder = tomorrowString;
        });
    </script>
</body>
</html>
